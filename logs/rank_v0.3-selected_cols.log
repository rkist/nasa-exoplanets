2025-10-05 19:13:58,014 INFO Starting trainer with args: {'data': 'data/frames/kepler_summary_with_labels.parquet', 'out': 'models/ranking/v0.3-selected_cols', 'epochs': 30, 'batch_size': 512, 'embed_dim': 128, 'heads': 8, 'layers': 4, 'dropout': 0.1, 'lr': 0.0002, 'sample_frac': 1.0, 'class_weight': False, 'oversample': True, 'clip_grad_norm': 1.0, 'weight_decay': 0.01, 'label_smoothing': 0.0, 'scheduler': 'plateau', 'lr_factor': 0.5, 'lr_patience': 2, 'early_stopping_patience': 5, 'seed': 42, 'log_file': 'logs/rank_v0.3-selected_cols.log', 'log_interval': 100, 'verbose': False, 'scores_out': 'models/ranking/v0.3-selected_cols/scores.csv', 'load_model_dir': '', 'eval_only': False, 'features': 'eff_temp,surface_gravity,metallicity,radius,reddening,extinction,gkcolor,grcolor,jkcolor', 'features_file': '', 'score_only_candidates': True}
2025-10-05 19:13:58,153 INFO Feature selection active: kept 9 numeric and 0 categorical (from 53/5)
2025-10-05 19:13:58,188 INFO Dataset: total=106978 train=70039 val=17510
2025-10-05 19:13:58,188 INFO Train class counts: NEG(0)=47007, POS(1)=23032
2025-10-05 19:13:58,188 INFO Val class counts:   NEG(0)=11752, POS(1)=5758
2025-10-05 19:13:58,188 INFO Num features=9 Cat features=0
2025-10-05 19:13:58,194 INFO Sampler: WeightedRandomSampler (oversampling)
2025-10-05 19:13:58,210 INFO Model: FT-Transformer embed_dim=128 heads=8 layers=4 dropout=0.1
2025-10-05 19:13:58,733 INFO Loss: BCEWithLogits
2025-10-05 19:13:58,733 INFO Optimizer: AdamW lr=0.0002 weight_decay=0.01
2025-10-05 19:13:58,733 INFO Scheduler: ReduceLROnPlateau factor=0.5 patience=2
2025-10-05 19:13:58,733 INFO Training: epochs=30 batch_size=512 steps_per_epoch=137
2025-10-05 19:14:40,039 INFO Epoch 1 Step 100/137 - lr 0.000200 - loss 0.5816
2025-10-05 19:14:57,999 INFO Epoch 1/30 - lr 0.000200 - loss 0.5741 - val f1 0.6159 - val auc 0.7982
2025-10-05 19:15:38,558 INFO Epoch 2 Step 100/137 - lr 0.000200 - loss 0.5409
2025-10-05 19:15:56,253 INFO Epoch 2/30 - lr 0.000200 - loss 0.5390 - val f1 0.6243 - val auc 0.8076
2025-10-05 19:16:37,195 INFO Epoch 3 Step 100/137 - lr 0.000200 - loss 0.5272
2025-10-05 19:16:54,650 INFO Epoch 3/30 - lr 0.000200 - loss 0.5247 - val f1 0.6330 - val auc 0.8172
2025-10-05 19:17:34,733 INFO Epoch 4 Step 100/137 - lr 0.000200 - loss 0.5137
2025-10-05 19:17:52,331 INFO Epoch 4/30 - lr 0.000200 - loss 0.5100 - val f1 0.6351 - val auc 0.8232
2025-10-05 19:18:32,838 INFO Epoch 5 Step 100/137 - lr 0.000200 - loss 0.5054
2025-10-05 19:18:50,688 INFO Epoch 5/30 - lr 0.000200 - loss 0.5058 - val f1 0.6495 - val auc 0.8318
2025-10-05 19:19:37,786 INFO Epoch 6 Step 100/137 - lr 0.000200 - loss 0.4957
2025-10-05 19:20:03,620 INFO Epoch 6/30 - lr 0.000200 - loss 0.4939 - val f1 0.6520 - val auc 0.8355
2025-10-05 19:21:01,843 INFO Epoch 7 Step 100/137 - lr 0.000200 - loss 0.4847
2025-10-05 19:21:28,382 INFO Epoch 7/30 - lr 0.000200 - loss 0.4837 - val f1 0.6644 - val auc 0.8471
2025-10-05 19:22:27,394 INFO Epoch 8 Step 100/137 - lr 0.000200 - loss 0.4760
2025-10-05 19:22:53,855 INFO Epoch 8/30 - lr 0.000200 - loss 0.4749 - val f1 0.6697 - val auc 0.8556
2025-10-05 19:23:54,890 INFO Epoch 9 Step 100/137 - lr 0.000200 - loss 0.4716
2025-10-05 19:24:21,441 INFO Epoch 9/30 - lr 0.000200 - loss 0.4674 - val f1 0.6868 - val auc 0.8715
2025-10-05 19:25:20,003 INFO Epoch 10 Step 100/137 - lr 0.000200 - loss 0.4498
2025-10-05 19:25:46,513 INFO Epoch 10/30 - lr 0.000200 - loss 0.4493 - val f1 0.6865 - val auc 0.8753
2025-10-05 19:26:45,353 INFO Epoch 11 Step 100/137 - lr 0.000200 - loss 0.4427
2025-10-05 19:27:11,857 INFO Epoch 11/30 - lr 0.000200 - loss 0.4402 - val f1 0.7006 - val auc 0.8789
2025-10-05 19:28:12,853 INFO Epoch 12 Step 100/137 - lr 0.000200 - loss 0.4239
2025-10-05 19:28:39,372 INFO Epoch 12/30 - lr 0.000200 - loss 0.4213 - val f1 0.7249 - val auc 0.9004
2025-10-05 19:29:38,934 INFO Epoch 13 Step 100/137 - lr 0.000200 - loss 0.4135
2025-10-05 19:30:09,039 INFO Epoch 13/30 - lr 0.000200 - loss 0.4126 - val f1 0.7446 - val auc 0.9131
2025-10-05 19:31:09,011 INFO Epoch 14 Step 100/137 - lr 0.000200 - loss 0.3961
2025-10-05 19:31:35,758 INFO Epoch 14/30 - lr 0.000200 - loss 0.3941 - val f1 0.7624 - val auc 0.9242
2025-10-05 19:32:36,981 INFO Epoch 15 Step 100/137 - lr 0.000200 - loss 0.3842
2025-10-05 19:33:03,295 INFO Epoch 15/30 - lr 0.000200 - loss 0.3823 - val f1 0.7767 - val auc 0.9320
2025-10-05 19:34:01,108 INFO Epoch 16 Step 100/137 - lr 0.000200 - loss 0.3672
2025-10-05 19:34:29,926 INFO Epoch 16/30 - lr 0.000200 - loss 0.3649 - val f1 0.7775 - val auc 0.9388
2025-10-05 19:35:27,600 INFO Epoch 17 Step 100/137 - lr 0.000200 - loss 0.3517
2025-10-05 19:35:53,326 INFO Epoch 17/30 - lr 0.000200 - loss 0.3484 - val f1 0.8016 - val auc 0.9473
2025-10-05 19:36:50,792 INFO Epoch 18 Step 100/137 - lr 0.000200 - loss 0.3373
2025-10-05 19:37:16,001 INFO Epoch 18/30 - lr 0.000200 - loss 0.3353 - val f1 0.8003 - val auc 0.9479
2025-10-05 19:38:14,742 INFO Epoch 19 Step 100/137 - lr 0.000200 - loss 0.3237
2025-10-05 19:38:40,205 INFO Epoch 19/30 - lr 0.000200 - loss 0.3228 - val f1 0.8239 - val auc 0.9619
2025-10-05 19:39:38,718 INFO Epoch 20 Step 100/137 - lr 0.000200 - loss 0.3109
2025-10-05 19:40:05,091 INFO Epoch 20/30 - lr 0.000200 - loss 0.3110 - val f1 0.8402 - val auc 0.9651
2025-10-05 19:41:03,416 INFO Epoch 21 Step 100/137 - lr 0.000200 - loss 0.2972
2025-10-05 19:41:30,643 INFO Epoch 21/30 - lr 0.000200 - loss 0.2946 - val f1 0.8525 - val auc 0.9707
2025-10-05 19:42:29,616 INFO Epoch 22 Step 100/137 - lr 0.000200 - loss 0.2810
2025-10-05 19:42:55,898 INFO Epoch 22/30 - lr 0.000200 - loss 0.2798 - val f1 0.8463 - val auc 0.9731
2025-10-05 19:43:52,899 INFO Epoch 23 Step 100/137 - lr 0.000200 - loss 0.2722
2025-10-05 19:44:19,117 INFO Epoch 23/30 - lr 0.000200 - loss 0.2685 - val f1 0.8770 - val auc 0.9805
2025-10-05 19:45:16,912 INFO Epoch 24 Step 100/137 - lr 0.000200 - loss 0.2562
2025-10-05 19:45:42,427 INFO Epoch 24/30 - lr 0.000200 - loss 0.2571 - val f1 0.8827 - val auc 0.9801
2025-10-05 19:46:40,240 INFO Epoch 25 Step 100/137 - lr 0.000200 - loss 0.2495
2025-10-05 19:47:06,365 INFO Epoch 25/30 - lr 0.000200 - loss 0.2472 - val f1 0.8897 - val auc 0.9852
2025-10-05 19:48:06,117 INFO Epoch 26 Step 100/137 - lr 0.000200 - loss 0.2358
2025-10-05 19:48:33,644 INFO Epoch 26/30 - lr 0.000200 - loss 0.2359 - val f1 0.8912 - val auc 0.9864
2025-10-05 19:49:32,345 INFO Epoch 27 Step 100/137 - lr 0.000200 - loss 0.2229
2025-10-05 19:49:59,424 INFO Epoch 27/30 - lr 0.000200 - loss 0.2206 - val f1 0.9065 - val auc 0.9890
2025-10-05 19:50:57,506 INFO Epoch 28 Step 100/137 - lr 0.000200 - loss 0.2202
2025-10-05 19:51:24,129 INFO Epoch 28/30 - lr 0.000200 - loss 0.2189 - val f1 0.9102 - val auc 0.9910
2025-10-05 19:52:22,948 INFO Epoch 29 Step 100/137 - lr 0.000200 - loss 0.2087
2025-10-05 19:52:48,752 INFO Epoch 29/30 - lr 0.000200 - loss 0.2076 - val f1 0.9206 - val auc 0.9919
2025-10-05 19:53:47,289 INFO Epoch 30 Step 100/137 - lr 0.000200 - loss 0.2021
2025-10-05 19:54:13,027 INFO Epoch 30/30 - lr 0.000200 - loss 0.2003 - val f1 0.9340 - val auc 0.9929
2025-10-05 19:54:17,718 INFO Final validation - f1 0.9340 - auc 0.9929
2025-10-05 19:54:17,725 INFO Binary validation report:
                precision    recall  f1-score   support

FALSE POSITIVE       0.99      0.94      0.97     11752
     CONFIRMED       0.90      0.98      0.93      5758

      accuracy                           0.95     17510
     macro avg       0.94      0.96      0.95     17510
  weighted avg       0.96      0.95      0.96     17510

2025-10-05 19:54:45,614 INFO Wrote scores to models/ranking/v0.3-selected_cols/scores.csv (rows=19429)
