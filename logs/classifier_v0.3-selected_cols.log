2025-10-05 19:19:22,220 INFO Starting trainer with args: {'data': 'data/frames/kepler_summary_with_labels.parquet', 'out': 'models/classifier/v0.3-selected_cols', 'epochs': 30, 'batch_size': 512, 'embed_dim': 128, 'heads': 8, 'layers': 4, 'dropout': 0.1, 'lr': 0.0002, 'sample_frac': 1.0, 'class_weight': False, 'oversample': True, 'clip_grad_norm': 1.0, 'weight_decay': 0.01, 'label_smoothing': 0.0, 'scheduler': 'plateau', 'lr_factor': 0.5, 'lr_patience': 2, 'early_stopping_patience': 5, 'seed': 42, 'log_file': 'logs/classifier_v0.3-selected_cols.log', 'log_interval': 100, 'verbose': False, 'features': 'eff_temp,surface_gravity,metallicity,radius,reddening,extinction,gkcolor,grcolor,jkcolor', 'features_file': ''}
2025-10-05 19:19:22,347 INFO Feature selection active: kept 9 numeric and 0 categorical (from 53/5)
2025-10-05 19:19:22,384 INFO Dataset: total=106978 train=85582 val=21396
2025-10-05 19:19:22,385 INFO Train class counts: CANDIDATE=15543, CONFIRMED=23032, FALSE POSITIVE=47007
2025-10-05 19:19:22,385 INFO Val class counts:   CANDIDATE=3886, CONFIRMED=5758, FALSE POSITIVE=11752
2025-10-05 19:19:22,385 INFO Num features=9 Cat features=0
2025-10-05 19:19:22,391 INFO Sampler: WeightedRandomSampler (oversampling)
2025-10-05 19:19:22,399 INFO Model: FT-Transformer embed_dim=128 heads=8 layers=4 dropout=0.1
2025-10-05 19:19:23,007 INFO Loss: CrossEntropy label_smoothing=0.000
2025-10-05 19:19:23,007 INFO Optimizer: AdamW lr=0.0002 weight_decay=0.01
2025-10-05 19:19:23,007 INFO Scheduler: ReduceLROnPlateau factor=0.5 patience=2
2025-10-05 19:19:23,007 INFO Training: epochs=30 batch_size=512 steps_per_epoch=168
2025-10-05 19:20:21,660 INFO Epoch 1 Step 100/168 - lr 0.000200 - loss 1.0340
2025-10-05 19:21:06,350 INFO Epoch 1/30 - lr 0.000200 - loss 1.0218 - val f1 0.5080
2025-10-05 19:22:05,056 INFO Epoch 2 Step 100/168 - lr 0.000200 - loss 0.9876
2025-10-05 19:22:51,175 INFO Epoch 2/30 - lr 0.000200 - loss 0.9850 - val f1 0.5330
2025-10-05 19:23:51,831 INFO Epoch 3 Step 100/168 - lr 0.000200 - loss 0.9768
2025-10-05 19:24:37,137 INFO Epoch 3/30 - lr 0.000200 - loss 0.9730 - val f1 0.5623
2025-10-05 19:25:36,410 INFO Epoch 4 Step 100/168 - lr 0.000200 - loss 0.9575
2025-10-05 19:26:22,172 INFO Epoch 4/30 - lr 0.000200 - loss 0.9533 - val f1 0.5547
2025-10-05 19:27:21,658 INFO Epoch 5 Step 100/168 - lr 0.000200 - loss 0.9338
2025-10-05 19:28:09,038 INFO Epoch 5/30 - lr 0.000200 - loss 0.9323 - val f1 0.5417
2025-10-05 19:29:08,851 INFO Epoch 6 Step 100/168 - lr 0.000200 - loss 0.9096
2025-10-05 19:29:57,958 INFO Epoch 6/30 - lr 0.000200 - loss 0.9064 - val f1 0.5207
2025-10-05 19:30:58,342 INFO Epoch 7 Step 100/168 - lr 0.000100 - loss 0.8777
2025-10-05 19:31:44,064 INFO Epoch 7/30 - lr 0.000100 - loss 0.8731 - val f1 0.5933
2025-10-05 19:32:45,619 INFO Epoch 8 Step 100/168 - lr 0.000100 - loss 0.8561
2025-10-05 19:33:30,414 INFO Epoch 8/30 - lr 0.000100 - loss 0.8501 - val f1 0.6243
2025-10-05 19:34:31,651 INFO Epoch 9 Step 100/168 - lr 0.000100 - loss 0.8381
2025-10-05 19:35:16,507 INFO Epoch 9/30 - lr 0.000100 - loss 0.8344 - val f1 0.6185
2025-10-05 19:36:13,923 INFO Epoch 10 Step 100/168 - lr 0.000100 - loss 0.8167
2025-10-05 19:36:58,141 INFO Epoch 10/30 - lr 0.000100 - loss 0.8122 - val f1 0.6333
2025-10-05 19:37:55,997 INFO Epoch 11 Step 100/168 - lr 0.000100 - loss 0.7964
2025-10-05 19:38:40,256 INFO Epoch 11/30 - lr 0.000100 - loss 0.7911 - val f1 0.6435
2025-10-05 19:39:38,721 INFO Epoch 12 Step 100/168 - lr 0.000100 - loss 0.7773
2025-10-05 19:40:23,020 INFO Epoch 12/30 - lr 0.000100 - loss 0.7736 - val f1 0.6302
2025-10-05 19:41:22,399 INFO Epoch 13 Step 100/168 - lr 0.000100 - loss 0.7669
2025-10-05 19:42:07,069 INFO Epoch 13/30 - lr 0.000100 - loss 0.7608 - val f1 0.6432
2025-10-05 19:43:06,038 INFO Epoch 14 Step 100/168 - lr 0.000100 - loss 0.7471
2025-10-05 19:43:50,418 INFO Epoch 14/30 - lr 0.000100 - loss 0.7418 - val f1 0.6832
2025-10-05 19:44:48,438 INFO Epoch 15 Step 100/168 - lr 0.000100 - loss 0.7295
2025-10-05 19:45:32,654 INFO Epoch 15/30 - lr 0.000100 - loss 0.7257 - val f1 0.6730
2025-10-05 19:46:29,804 INFO Epoch 16 Step 100/168 - lr 0.000100 - loss 0.7108
2025-10-05 19:47:14,131 INFO Epoch 16/30 - lr 0.000100 - loss 0.7110 - val f1 0.7039
2025-10-05 19:48:14,981 INFO Epoch 17 Step 100/168 - lr 0.000100 - loss 0.6944
2025-10-05 19:49:00,625 INFO Epoch 17/30 - lr 0.000100 - loss 0.6915 - val f1 0.7213
2025-10-05 19:50:00,464 INFO Epoch 18 Step 100/168 - lr 0.000100 - loss 0.6768
2025-10-05 19:50:45,271 INFO Epoch 18/30 - lr 0.000100 - loss 0.6759 - val f1 0.6971
2025-10-05 19:51:43,759 INFO Epoch 19 Step 100/168 - lr 0.000100 - loss 0.6658
2025-10-05 19:52:29,451 INFO Epoch 19/30 - lr 0.000100 - loss 0.6641 - val f1 0.7284
2025-10-05 19:53:27,980 INFO Epoch 20 Step 100/168 - lr 0.000100 - loss 0.6490
2025-10-05 19:54:12,568 INFO Epoch 20/30 - lr 0.000100 - loss 0.6451 - val f1 0.7373
2025-10-05 19:55:02,002 INFO Epoch 21 Step 100/168 - lr 0.000100 - loss 0.6320
2025-10-05 19:55:33,961 INFO Epoch 21/30 - lr 0.000100 - loss 0.6279 - val f1 0.7352
2025-10-05 19:56:16,686 INFO Epoch 22 Step 100/168 - lr 0.000100 - loss 0.6171
2025-10-05 19:56:49,447 INFO Epoch 22/30 - lr 0.000100 - loss 0.6129 - val f1 0.7631
2025-10-05 19:57:31,456 INFO Epoch 23 Step 100/168 - lr 0.000100 - loss 0.6060
2025-10-05 19:58:02,673 INFO Epoch 23/30 - lr 0.000100 - loss 0.6003 - val f1 0.7935
2025-10-05 19:58:43,657 INFO Epoch 24 Step 100/168 - lr 0.000100 - loss 0.5897
2025-10-05 19:59:14,815 INFO Epoch 24/30 - lr 0.000100 - loss 0.5855 - val f1 0.7763
2025-10-05 19:59:56,363 INFO Epoch 25 Step 100/168 - lr 0.000100 - loss 0.5726
2025-10-05 20:00:31,582 INFO Epoch 25/30 - lr 0.000100 - loss 0.5738 - val f1 0.8007
2025-10-05 20:01:23,153 INFO Epoch 26 Step 100/168 - lr 0.000100 - loss 0.5611
2025-10-05 20:02:02,111 INFO Epoch 26/30 - lr 0.000100 - loss 0.5583 - val f1 0.7915
2025-10-05 20:02:54,127 INFO Epoch 27 Step 100/168 - lr 0.000100 - loss 0.5453
2025-10-05 20:03:33,491 INFO Epoch 27/30 - lr 0.000100 - loss 0.5424 - val f1 0.7889
2025-10-05 20:04:23,962 INFO Epoch 28 Step 100/168 - lr 0.000100 - loss 0.5328
2025-10-05 20:05:01,955 INFO Epoch 28/30 - lr 0.000100 - loss 0.5298 - val f1 0.8110
2025-10-05 20:05:52,018 INFO Epoch 29 Step 100/168 - lr 0.000100 - loss 0.5251
2025-10-05 20:06:30,490 INFO Epoch 29/30 - lr 0.000100 - loss 0.5190 - val f1 0.8282
2025-10-05 20:07:21,491 INFO Epoch 30 Step 100/168 - lr 0.000100 - loss 0.5113
2025-10-05 20:07:59,344 INFO Epoch 30/30 - lr 0.000100 - loss 0.5083 - val f1 0.8225
2025-10-05 20:07:59,385 INFO Classification report:
                precision    recall  f1-score   support

     CANDIDATE       0.62      0.95      0.75      3886
     CONFIRMED       0.80      0.86      0.83      5758
FALSE POSITIVE       0.96      0.75      0.84     11752

      accuracy                           0.82     21396
     macro avg       0.79      0.85      0.81     21396
  weighted avg       0.85      0.82      0.82     21396

